####################################################################################################
#
# This file contains environments for running GHRSST MODIS L2P and MAF processing subsystems.
#
# This file will be sourced by all cronjobs to fetch the environment variables used within
# Perl and IDL codes.
#
# Assumption:
#
#   1. It will be stored in $HOME/ directory with the name define_ghrsst_operation_environment
#      The cronjobs must refer to this name so it cannot be a softlink.
#   2. The softlink $HOME/ghrsst_ops refers to the location of all software related to
#      MODIS L2P and MAF processing. 
# 
#
####################################################################################################

# Set environment for sigevent manager.

setenv GHRSST_SIGEVENT_URL http://prawn.jpl.nasa.gov:8080

# Flag to perform a move instead of copy when staging the HDF file to scratch.
# This save IO.
# This can only be done if the user account has write permissions.

# For OPS, this value is yes, for DEV, it should be no
setenv PERFORM_MOVE_INSTEAD_OF_COPY_WHEN_STAGING_HDF_FILE yes
#setenv PERFORM_MOVE_INSTEAD_OF_COPY_WHEN_STAGING_HDF_FILE no

# Points to where the Perl & IDL codes are installed.

setenv GHRSST_PERL_LIB_DIRECTORY $HOME/ghrsst_ops/

# Configuration files

setenv GHRSST_DATA_CONFIG_FILE $GHRSST_PERL_LIB_DIRECTORY/resources/ghrsst_data_config_file.dat
setenv MAF_THRESHOLD_CONFIG_FILE $GHRSST_PERL_LIB_DIRECTORY/resources/maf_threshold_config.dat
setenv GHRSST_CLUSTER_HOST_FILENAME_LIST $GHRSST_PERL_LIB_DIRECTORY/resources/host_list.txt

# Scratch directory to store temporary files, MAFs and registry.

setenv SCRATCH_AREA         $HOME/ghrsst-rdac/scratch     
setenv MAF_OUTPUT_DIRECTORY $HOME/ghrsst-rdac/scratch
setenv SCRATCH_ECMWF_WRITE_FLAG_FILE $SCRATCH_AREA/ecmwf_dataset_written
setenv SCRATCH_FNMOC_WRITE_FLAG_FILE $SCRATCH_AREA/fnmoc_dataset_written
setenv QUICKLOOK_FILE_ERROR_REGISTRY_FILENAME $SCRATCH_AREA/ghrsst_master_error_file_registry_quicklook.dat
setenv REFINED_FILE_ERROR_REGISTRY_FILENAME   $SCRATCH_AREA/ghrsst_master_error_file_registry_refined.dat

# Environment for logging
setenv GAPFARMPROCESSINGLOGFILENAME          ghrsst_processing_log_archive.txt # Set to the name of the log file where each MODIS L2P job will log to.


#
# Flag to determine if MODIS L2P should be sent and to what machine.
#

# Set this to true to push the MODIS L2P to melia once it is created.
# Set to false for dev/test.

setenv SEND_MODIS_L2P_TO_MELIA_FLAG false
#setenv SEND_MODIS_L2P_TO_MELIA_FLAG true

# Set this to true to push the MODIS L2P to seatide/seafire once it is created.
# Set to false for dev/test if only wish to create the MODIS L2P and not sftp it.

setenv SEND_MODIS_L2P_TO_DMAS_FOR_INGESTION_FLAG false
########## YC 5/15/13 set to false for no sftp seatide, use ghrsst-rdac1 gds2 data handler instead
########## setenv SEND_MODIS_L2P_TO_DMAS_FOR_INGESTION_FLAG true

# Set this to the appropriate machine to push the MODIS L2P once it is created.
# For dev/test, use seatide, for ops, use seafire machine.

setenv SEND_MODIS_L2P_SFTP_AUTHENTICATION_INFO gftpin@ops-seafire.jpl.nasa.gov


# Directory to keep the wgrib readers

setenv GRIB_READER $GHRSST_PERL_LIB_DIRECTORY/../wgrib/wgrib


# Directory holding the MODIS current jobs

setenv MODIS_CURRENT_JOBS_DIR $SCRATCH_AREA/current_jobs

# Directory holding the MODIS L2P Core: assumption, this directory must have been created already.

setenv MODIS_SEATMP_L2P_CORE_DIRECTORY /rdac/data/scratch/ghrsst-rdac/MODIS_L2P_CORE_NETCDF

### 1/23/17 - Added new VIIRS SEATMP setting for Generate 6.1.0
setenv VIIRS_SEATMP_L2P_CORE_DIRECTORY /rdac/data/scratch/ghrsst-rdac/VIIRS_L2P_CORE_NETCDF


# Directories for regression tests.

setenv BASELINE_REGRESSION_CATALOGUE_INPUT  $GHRSST_PERL_LIB_DIRECTORY/baseline/input
setenv BASELINE_REGRESSION_CATALOGUE_OUTPUT $GHRSST_PERL_LIB_DIRECTORY/baseline/output

# Directories to hold common locks.

setenv SEMAPHORE_LOCK_COMMON_AREA $HOME/ghrsst-rdac/common

# Environments for monitor programs.  The list of names in these settings is to control
# who gets notified about what.

setenv MACHINE "ops-ghrsst-rdac1"
setenv GENERATE_VERSION "Generate 6.2.3"

setenv OPS_DISK_MONITOR_EMAIL_LIST "timothy.b.mcknight@jpl.nasa.gov,ying.chen@jpl.nasa.gov,max.k.marler@jpl.nasa.gov"
setenv OPS_MAF_MONITOR_EMAIL_LIST  "timothy.b.mcknight@jpl.nasa.gov,ying.chen@jpl.nasa.gov,max.k.marler@jpl.nasa.gov"
setenv OPS_MODIS_MONITOR_EMAIL_LIST "timothy.b.mcknight@jpl.nasa.gov,ying.chen@jpl.nasa.gov,max.k.marler@jpl.nasa.gov,edward.m.armstrong@jpl.nasa.gov"
setenv OPSMAILSRC                   "daacops@ops-ghrsst-rdac1.jpl.nasa.gov"

# Directory to look for "filled" Quicklook MODIS L2P
# Assumption: it is mounted.

setenv GHRSST_PUBLIC_STORE_DATA_L2P     /store-old/ghrsst/public/data/L2P
setenv RDAC_INSTITUTION_NAME            JPL

# Resource directory needed for FNMOC related processing:
#
# The two files in this directory should be:
#
#    grdlat_sfc_000000_000000_1o3241x2441_00000000_datafld
#    grdlon_sfc_000000_000000_1o3241x2441_00000000_datafld
#

setenv FNMOC_LATLON_GRID_DEF_DIRECTORY $GHRSST_PERL_LIB_DIRECTORY/resources/

##########################################################################################################
#
# GDS2 related settings.
#
##########################################################################################################

# Environment to create the MODIS L2P in GDS2 format or not.
# The default is to create the MODIS L2P in GDS1 format if not specified.

setenv CREATE_MODIS_L2P_IN_GDS2_FORMAT true

# Normally, the GDS2 files are not compressed.

setenv FORCE_COMPRESS_GDS2_FORMAT_FLAG false

# If the GDS2 is to be compressed, it defaults to BZ2 if not specified.

setenv GHRSST_MODIS_L2P_COMPRESSION_TYPE BZ2

# The GDS2 is internally compressed.  The default chunking level is 5 if not specified.

setenv GHRSST_MODIS_L2P_CHUNKING_COMPRESSION_LEVEL 5

# If the following 2 variables are set to false or not set at all,
# the GDS2 file will contain these variables with fill values.

setenv GHRSST_IGNORE_WRITE_WIND_SPEED_VARIABLE_IN_GDS2_FILE   false
setenv GHRSST_IGNORE_WRITE_DT_ANALYSIS_VARIABLE_IN_GDS2_FILE  false

# Environment to show debug printing while running IDL programs/functions.
# If set to 'false' or not set at all, none of the printing will take place.

setenv GHRSST_MODIS_L2P_DEBUG_MODE 'false'

# Extra settings for moving MODIS L2P back to GAPIO for ancillary filling.
# Set flag GAPPUSHL2PFORANCILLARYFILLING to 'true' for pushing back L2P to GAPIO

setenv GAPPUSHL2PFORANCILLARYFILLING 'false'

# Directory to push MODIS L2P back to GAPIO for ancillary filling.
setenv GAPIO /rdac/incoming/data/apstage/

# 7/15/15 New setting will use the new apply_scaling_from_short_to_byte() function to properly scale some
# variables from short to byte and correct the scale_factor and add_offset values.
setenv GHRSST_MODIS_L2P_CONVERTING_FROM_ORIGINAL_NETCDF_FILES true
